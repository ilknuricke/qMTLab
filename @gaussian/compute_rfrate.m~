function compute_rfrate(p, lineshape, T2, offset, TR)
%
%  function compute_rfrate(lineshape, T2, offset)
%
%  p          :  pulse object
%  lineshape  :  function(w, T2)
%  T2         :
%  offset     :  frequency offset of lineshape
%  TR         :  repetition period for pulse

width = 3;

w0 = width/p.s2-p.dw;
w1 = width/p.s2+p.dw;


p.rfrate = quad('spectrum', w0, w1, [], [], lineshape, T2, offset, p.A, p.s2, p.dw);



